# 管理员设置说明

## 🔐 如何设置管理员

### 方法一：通过 .env 配置文件（推荐）

编辑项目根目录的 `.env` 文件，修改 `ADMIN_IDS` 配置：

```bash
# 单个管理员
ADMIN_IDS=7912446575

# 多个管理员（用逗号分隔）
ADMIN_IDS=7912446575,123456789,987654321
```

**修改后需要重启应用才能生效！**

### 方法二：通过 Web 管理后台

1. 使用默认账号登录：`admin` / `admin`
2. 在管理后台中添加新的管理员账号
3. 注意：Web 后台的管理员账号和 Telegram Bot 的管理员是不同的

### 方法三：直接在数据库中添加

如果需要通过数据库直接添加：

```sql
-- 连接到数据库
sqlite3 data/bot.db

-- 添加管理员账号（Web后台登录用）
INSERT INTO admin_users (username, password_hash) 
VALUES ('your_username', 'hashed_password');

-- 注意：password_hash 需要使用 werkzeug.security.generate_password_hash() 生成
```

## 📋 两种管理员类型

### 1. Telegram Bot 管理员

- **配置位置**：`.env` 文件中的 `ADMIN_IDS`
- **作用**：可以在 Telegram Bot 中使用管理功能
- **获取方式**：在 Telegram 中搜索 `@userinfobot`，发送任意消息即可看到你的用户 ID

### 2. Web 管理后台管理员

- **存储位置**：数据库 `admin_users` 表
- **作用**：可以登录 Web 管理后台
- **默认账号**：`admin` / `admin`（首次启动自动创建）

## 🔍 如何获取 Telegram 用户 ID

1. 在 Telegram 中搜索 `@userinfobot`
2. 发送任意消息给这个机器人
3. 它会返回你的用户 ID（例如：`7912446575`）
4. 将这个 ID 添加到 `.env` 文件的 `ADMIN_IDS` 中

## ⚙️ 当前配置

根据你的错误日志，用户 ID `7912446575` 还不是管理员。

**快速设置步骤：**

1. 编辑 `.env` 文件：
   ```bash
   ADMIN_IDS=7912446575
   ```

2. 重启应用：
   ```bash
   # 停止当前应用
   ./scripts/stop.sh
   
   # 重新启动
   ./scripts/start.sh
   ```

3. 验证：在 Telegram Bot 中发送 `/start`，如果看到 "⚙️ 管理后台" 按钮，说明设置成功。

## ⚠️ 注意事项

1. **多个管理员**：用逗号分隔，不要有空格
   ```bash
   ADMIN_IDS=7912446575,123456789  # ✅ 正确
   ADMIN_IDS=7912446575, 123456789  # ❌ 错误（有空格）
   ```

2. **重启生效**：修改 `.env` 后必须重启应用

3. **安全性**：不要将 `.env` 文件提交到 Git（已在 .gitignore 中）

4. **Web 后台密码**：首次登录后请立即修改默认密码 `admin`

